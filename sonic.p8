pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
p_x=16
p_y=184
p_dx=0
p_dy=0
p_dir=false
p_animate=1

function _init()
 cls()
	palt(0,false)
	palt(5,true)
	map(0,0,0,0,128,64)
	camera()
end

function slope_fix()
	if(mget(flr(p_x/8),ceil(p_y/8)+2)==65) p_y=ceil(p_y/8)*8
	if(fget(mget(flr(p_x/8),ceil(p_y/8)+2),7) or fget(mget(flr(p_x/8)+1,ceil(p_y/8)+2),7)) then
		while true do
			for i=flr(p_x),flr(p_x+7) do
				in_ground=false
				p=pget(i,p_y+16)
				if(p==3 or p==4 or p==9 or p==11) then
					in_ground=true
					break
				end
			end
			if(in_ground) then
				break
			else p_y+=1 end
		end
	end
	if(fget(mget(flr(p_x/8),ceil(p_y/8)+1),7) or fget(mget(flr(p_x/8)+1,ceil(p_y/8)+1),7)) then
		while true do
			for i=flr(p_x),flr(p_x+7) do
				in_ground=false
				p=pget(i,p_y+15)
				if(p==3 or p==4 or p==11) then
					in_ground=true
					break
				end
			end
			if(in_ground) then
				p_y-=1
			else break end
		end
	end
end

function _update()
	if(p_dx==0) then
		p_animate=1
	else
		p_animate += 1
		if(p_animate>3)p_animate=2
	end
	if(not(btn(0) or btn(1))) then
		m=mget(flr(p_x/8+0.5),ceil(p_y/8)+2)
		if(fget(m,6)) then
			if(p_dx<0)p_dx+=0.5
			p_dx=min(p_dx+0.1,3)
		elseif(fget(m,5)) then 
			if(p_dx>0)p_dx-=0.5
			p_dx=max(p_dx-0.1,-3)
		else
			if(p_dx>0)p_dx=max(p_dx-0.8,0)
			if(p_dx<0)p_dx=min(p_dx+0.8,0)
		end
	end
	if(btn(0)) then
		p_dx=max(p_dx-0.2,-5)
		if not p_dir then
			p_dx-=0.8
			p_dir=true
		end
	end
	if(btn(1)) then
		p_dx=min(p_dx+0.2,5)
		if(p_dx<-5)p_dx+=1
		if p_dir then
			p_dx+=0.8
			p_dir=false
		end
	end
	p_ub=mget(ceil((p_x)/8),ceil(p_y/8)) --upper body collision sprite
	p_lb=mget(ceil((p_x)/8),ceil(p_y/8)+1) --lower body collision sprite
	if(p_ub==114 or p_lb==114) p_dx=-16
	p_x+=p_dx
	if(p_x<0) then
		p_x=0
		p_dx=0
	end
	slope_fix()
end

function _draw()
	cls()
	cam_x=mid(0,p_x-32,896)
	cam_y=mid(0,p_y-56,128)
	camera(cam_x/3,cam_y)
	map(0,32,0,0,128,32)
	camera(cam_x,cam_y)
	map(0,0,0,0,128,32)
	spr(p_animate,p_x,p_y,1,2,p_dir)
end
__gfx__
55555555511155155111551551115515555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
555555551ccc11c11ccc11c11ccc11c1555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555cc9cccc1cc9cccc1cc9cccc1555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
555555551c9c70611c9c70611c9c7061555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
555555551cc770701cc770701cc77070555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
5555555551c9777951c9777951c97779555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555551999995519999955199999555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555551119955511199555111995555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55111155555191155551911555519115555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
51cccc15555897855558978555589785555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1c7cccc1556877865568778655687786555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
17ccccd1577c9967577c9967577c9967555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
17ccccd15661cc155661cc155661cc15555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1ccccdd1555155155511551555515115555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
51cddd15555155155515551555515155555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55111155555985985598559855598985555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55111155555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
51c7cc15555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1c7cccc1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
17ccccd1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1cccccd1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1ccccdd1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
51cddd15555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55111155555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55111155555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
51c77c15555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1c7cccc1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1cccccd1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1cccccd1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
1ccccdd1555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
51cddd15555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
55111155555555555555555555555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
444499993bbb3bbb355555553b5555555555555555555555555555b35555555b5555555555555555555555555555555555555555555555555555555555555555
444499993bbb3bbb3b5555553bbb555555555555555555555555bbb0555555b35555555555555555555555555555555555555555555555555555555555555555
444499993bbb3bbb0bb5555503bb3b55555555555555555555b3bb3055555bb35555555555555555555555555555555555555555555555555555555555555555
4444999903b303b303bb555503bb03bb5555555555555555bb30bb0455550bb35555555555555555555555555555555555555555555555555555555555555555
9999444403b303b303b3055503b303bb3b555555555555b3bb303b04555b0bb3555555b355555555555555555555555555555555555555555555555555555555
999944449030403003b30b5590b303bb03bb55555555bb30bb303b0455b30b305555bb3055555555555555555555555555555555555555555555555555555555
999944449909440403b003b590b040b303bb3b5555b3bb303b090b045bb30b3055b3bb3055555555555555555555555555555555555555555555555555555555
9999444499994444903040b0903040b090bb03bbbb30bb040b090304bbb303045b30bb0455555555555555555555555555555555555555555555555555555555
9444999944449994440490b04404903040b303bbbb303b09030490993b3090993b303b0955555555555555555555555555555555555555555555555555555555
4944999944449949444490b044449909403090bb3b040309404499990b3099993b04030955555555555555555555555555555555555555555555555555555555
94449999444499944444903044449999440490b33b049099444499990b3099993b04909955555555555555555555555555555555555555555555555555555555
49449999444499494444990944449999444490300b049999444499990b3099990b04999955555555555555555555555555555555555555555555555555555555
94994444999944949999444499994444999944040309444499994444030944440309444455555555555555555555555555555555555555555555555555555555
49994444999944499999444499994444999944449099444499994444909944444099444455555555555555555555555555555555555555555555555555555555
94994444999944949999444499994444999944449999444499994444999944449499444455555555555555555555555555555555555555555555555555555555
49994444999944499999444499994444999944449999444499994444999944444999444455555555555555555555555555555555555555555555555555555555
55555555555555551111111111111111111111111111111103bb3bbb3bbb3b301111111111111111555555554444999955555555555555555555555555555555
5555555555555555111111111111a11111117111111166113bbb3bbb3bbb3bb31117111111111111555555554444999955555555555555555555555555555555
5550555555555555111111111111111111711111661111163bbb3bbb3bbb3bb31111117711111111555555554444999955555555555555555555555555555555
55570555555555551111111111a11111111111711116611103b303b303b303b3111117aa71111111555555554444999955555555555555555555555555555555
555705555555555511111111111111a1111171116161111103b303b303b303b311117aa711111111555555559999444455555555555555555555555555555555
55570555555555551111111111111111111111111116166640304030903040301117aaa711111111655555666999446655555555555555555555555555555555
5576d05555555555111111111a111111117111111661111194094404990944041117aaa711171111600600066006000655555555555555555555555555555555
5576d055555555551111111111111111111111111111111149994444999944491117aaaa777a7111666666666666666655555555555555555555555555555555
5576d0554444444494405555550000556666666666666666944499994444999411177aaaaaaa7111666666666666666655555555555555555555555555555555
5576d055aaaaaaaaaaa0005050aaaa05600aa00660000006494499994444994911117aaaaaa71111600000066000000655555555555555555555555555555555
5576d05590777d9077aa0c0c07700aa060a00906600c000694449999444499941111177aaa711111600077066009900655555555555555555555555555555555
576ddd05007dd0007aaa0c0c070500a0670000966070070649449999444499491711117777111111600077066009900655555555555555555555555555555555
576ddd05aa7dd0aaa9990101070500a06a0000966000000694994444999944941111111111111111600898066099990655555555555555555555555555555555
576ddd0544444444a99901010aa00aa060a00a066007000649994444999944491111111111111711608898066009900655555555555555555555555555555555
576ddd05040404049990005050aaaa05600aa00660c0000694994444999944941111117111111111600000066000000655555555555555555555555555555555
576ddd05000000009440555555000055666666666666666649994444999944491111111111111111666666666666666655555555555555555555555555555555
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262686962626263626262626462626262626262626262626262646262626262626262626262686962626262626262626262626262626262626262626262636
26262626462626262626262626262626262686962626262626262626262626262626262626262626362626262646262626268696262626262626262626262626
26262687972646262626262626262626362626262626462626262626262636262626262646262687973626262626462626262626262626262626262626462626
26262626262626362626262626462626262687972626264626262626262626262626262626264626262626262626262636268797262626462626262626262626
26362626262626262626262626462626262626262626262626263646262626262626262626262626362626262626262626362626262626263626262626262626
26262626462626262626262626262626263626262626262626263626262626262636262626262626262626262646262626262626262626262626362626262626
26262626262626262626262626262626362626262626362626262626262636262626262636262626262626262626462626262626262626262626262626262626
26262626262626362626262626362626262626262626264626262626262626262626262626262626262626262626262636262626262626462626262626262626
26262626262626262626362626262626262626262626262626262626262626262626262626262626262626262626262626362626262626262626262626262626
26362626262626262626262626262626262626262626262626263626262626262626262626262626262636262626262626262626262626262626362626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626362626262626262626262626262626262626262626
26262626262626262626262626262626262626263626262626262626262626262626262626262626262626262626262626262626362626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
56565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656
56565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626
__gff__
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c1c1c1a1a1a1a1000000000000000000c0c0c0a0a0a0a0000000000000000400000000000101000000000000000004010000030301010000030300000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000073737300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000073730000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000073730000000000000000
0000000000000000000000000000000000740000000000000000000000000000000000000073730000000000000000000000000000000000000000000000737373000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000737300000066416700000073730000000000000000000000000000000000000000750000000000000000000000000000000073737373730000000000000000000000000000000000000000000073737300000000000000000000000000000000000000737373730000000000000045464141414141
0000000000000000000000000000000050405100000000000000000000000000007373000000000000454641414142000000000000000000000000000000000000000000000000007373000000000000737300000000000000000000000000000000000000000000000000000000000000000000000000454655564040404040
0000000000000000000000000000000050405100000000000000000000000000000000000000004546555640404052420000000000000000000000000000000000000000000000000000000000000000000000000000000073737300000000000000000000000000000000000000000000000000004546555640404040404040
0000000000000000000000000000000050405100000000000000000000000000000000000045465556404040404040524200000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000000000000000000000000045466700007171000066415556404040404040404040
0000000000000000004546414141414141414141414200000073737373000000000000454655564040404040404040405242000000000073730000000066414141670000006641670000000000000000664143440000000000000000004546420000000000000000454655565100000000000076404040404040404040404040
0000000000000045465556404040404040404040405242000000000000000000004546555640404040404040404040404052420000000000000000000050404040510000007640770000000000000000764053544344004546414141415556524200000000004846555640405100000000000076404040404040404040404040
4141414141414155564040404040404040404040404052420000000000000045465556404040404040404040404040404040524200000000000000000050404040510000007640770000007171000000764040405354415556404040404040405242000000005856404040405100000000000076404040404040404040404040
40404040404040404040404040404040404040404040405242000000004546555640404040404040404040404040404040404052420000000000000000504040405100007276407700000000000000007640404040404040404040404040404040524200000050404040407b5100000000000076404040404040404040404040
4040404040404040404040404040404040404040404040405241414141555640404040404040404040404040404040404040404052414141414141414141414141414141417640770000000000000000764040404040404040404040404040404040524141414141414141416700000000000076404040404040404040404040
4040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040407640776060606060606060764040404040404040404040404040404040404040404040404040407760606060606076404040404040404040404040
4040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040407640777070707070707070764040404040404040404040404040404040404040404040404040407770707070707076404040404040404040404040
4040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040404040407640774141414141414141764040404040404040404040404040404040404040404040404040407741414141414176404040404040404040404040
